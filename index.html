<!DOCTYPE html>
<html>
<head>
    <script src="https://telegram.org/js/telegram-web-app.js"></script>
    <title>TikTok Feed</title>
    <style>
        body { margin: 0; background: #000; }
        video { width: 100%; height: 100vh; }
        .error { color: white; padding: 20px; text-align: center; }
    </style>
</head>
<body>
    <video id="player" controls autoplay></video>
    
    <script>
        const tg = window.Telegram.WebApp;
        tg.expand();
        tg.ready();
        
        
        const videos = [
            https://youtu.be/sqexpq2Au8o?si=61GKiJ2WCF2KKJ38
            https://youtu.be/sqexpq2Au8o?si=61GKiJ2WCF2KKJ38
        https://youtu.be/sqexpq2Au8o?si=61GKiJ2WCF2KKJ38
        https://youtu.be/sqexpq2Au8o?si=61GKiJ2WCF2KKJ38
        https://youtu.be/sqexpq2Au8o?si=61GKiJ2WCF2KKJ38
        https://youtu.be/sqexpq2Au8o?si=61GKiJ2WCF2KKJ38
        https://youtu.be/sqexpq2Au8o?si=61GKiJ2WCF2KKJ38
        https://youtu.be/sqexpq2Au8o?si=61GKiJ2WCF2KKJ38
        https://youtu.be/sqexpq2Au8o?si=61GKiJ2WCF2KKJ38
        https://youtu.be/sqexpq2Au8o?si=61GKiJ2WCF2KKJ38
        
        ];
        
        let current = 0;
        const player = document.getElementById('player');
        
        // Проверяем, грузятся ли видео
        function testVideo(url) {
            return new Promise((resolve) => {
                const test = new Audio();
                test.src = url;
                test.oncanplay = () => resolve(true);
                test.onerror = () => resolve(false);
                setTimeout(() => resolve(false), 3000);
            });
        }
        
        async function playVideo(index) {
            const url = videos[index];
            console.log('Пробуем загрузить:', url);
            
            const isWorking = await testVideo(url);
            
            if(isWorking) {
                player.src = url;
                player.play().catch(e => {
                    console.log('Автовоспроизведение заблокировано');
                    player.controls = true;
                });
            } else {
                console.log('Видео не грузится, пробуем следующее');
                current = (current + 1) % videos.length;
                setTimeout(() => playVideo(current), 1000);
            }
        }
        
        // Свайп
        let startY;
        document.addEventListener('touchstart', e => {
            startY = e.touches[0].clientY;
        });
        
        document.addEventListener('touchend', e => {
            if(startY - e.changedTouches[0].clientY > 50) {
                current = (current + 1) % videos.length;
                playVideo(current);
            }
        });
        
        // Старт
        playVideo(0);
        
        // Кнопка перезагрузки если все сломалось
        const reloadBtn = document.createElement('button');
        reloadBtn.textContent = 'Обновить видео';
        reloadBtn.style = 'position:fixed; bottom:20px; left:20px; z-index:1000; padding:10px;';
        reloadBtn.onclick = () => playVideo(current);
        document.body.appendChild(reloadBtn);
    </script>
</body>
</html>
